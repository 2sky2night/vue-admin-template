import{_ as w,u as $}from"./index-b8f1988d.js";import{J as V,r as h,o as L,c as S,X as n,u as R,a as c,W as C,L as T,ah as E,aw as H,$ as N,R as u,ai as v,ay as U,az as B,V as x}from"./@vue-cb7885ae.js";import{S as P}from"./vue3-slide-verify-5911f9f4.js";import{a as X}from"./axios-707ed124.js";import{N as b}from"./nprogress-360dbc20.js";import{E as p}from"./element-plus-1b9aa95a.js";import{u as j}from"./vue-router-17231333.js";import"./pinia-b26a74c5.js";import"./vue-demi-71ba0ef2.js";import"./@element-plus-91cae1ef.js";import"./lodash-es-36eb724a.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-93a65184.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-463e90e0.js";const q=""+new URL("year2022.4983644a-4983644a.svg",import.meta.url).href,z={class:"silde_box"},A=V({__name:"Vcode",props:{stateHandler:{type:Function}},setup(e){const o=e,t=h(""),r=h(),s="向右滑动->",m=1,_=h(!1),i=()=>{var a;t.value="检测到非人为操作的哦！ try again",(a=r.value)==null||a.refresh()},d=a=>{t.value=`太厉害了! 本次验证耗时${(a/1e3).toFixed(1)}s`,_.value=!0,o.stateHandler(!0)},f=()=>{t.value="验证不通过",_.value=!1,o.stateHandler(!1)};return(a,g)=>(L(),S("div",z,[n(R(P),{ref_key:"block",ref:r,"slider-text":s,accuracy:m,onAgain:i,onSuccess:d,onFail:f},null,512),c("div",{class:T(`code-tips ${_.value?"success":"error"}`)},C(t.value),3)]))}});const F=w(A,[["__scopeId","data-v-41529afc"]]);function D(){return new Promise((e,o)=>{const t=document.createElement("div");t.classList.add("vcode-container"),setTimeout(()=>{t.classList.add("vcode-container-enter")});const s=E(F,{stateHandler:m=>{m?(e("success"),t.classList.remove("vcode-container-enter"),setTimeout(()=>{t.classList.add("vcode-container-leave")},1e3),setTimeout(()=>{t.remove()},1900)):o("fail")}});H(s,t),document.body.insertAdjacentElement("beforeend",t)})}const l=X.create({baseURL:"https://mock.presstime.cn/mock/643b809c7e9ae476cd8b645f/admin-test"});l.interceptors.request.use(e=>{b.start();const o=localStorage.getItem("token");return o&&(e.headers.Authorization="Bearer "+o),e},e=>(p.error("加载失败,请稍后再试!"),Promise.reject(e)));l.interceptors.response.use(e=>(b.done(),e.data),e=>(p.error("加载失败,请稍后再试!"),b.done(),Promise.reject(e)));const J={get(e,o={},t){return l.get(e,{params:o,...t})},post(e,o={},t={},r){return l.post(e,o,{params:t,...r})},delete(e,o={},t){return l.delete(e,{params:o,...t})},patch(e,o={},t={},r){return l.patch(e,o,{params:t,...r})},put(e,o={},t={},r){return l.put(e,o,{params:t,...r})}},M=(e,o)=>J.get("/login",{usename:e,password:o}),k=e=>(U("data-v-4b221408"),e=e(),B(),e),W={class:"login-page"},G=k(()=>c("div",{class:"login-infor"},[c("h2",null,"XXX后台管理系统"),c("img",{src:q})],-1)),K={class:"login-form"},O=k(()=>c("h1",null,"登陆",-1)),Q={class:"code-box el-form-item"},Y=k(()=>c("div",{class:"el-form-item__label"},"验证码",-1)),Z=V({__name:"Login",setup(e){const o=$(),t=h(!1),r=j(),s=N({usename:"",password:""});async function m(){try{await D(),t.value=!0,p.success("验证成功")}catch{p.error("验证失败")}}async function _(){if(!s.usename||!s.password){p.error("登录失败,请输入有效字段!");return}try{const i=await M(s.usename,s.password);o.setToken(i.data.token),localStorage.setItem("token",i.data.token),r.push("/dashboard"),console.log(r.getRoutes())}catch{p.error("登录失败,请稍后再试!")}}return(i,d)=>{const f=v("el-input"),a=v("el-form-item"),g=v("el-button"),I=v("el-form");return L(),S("div",W,[G,c("div",K,[O,n(I,{model:s,"label-position":"top"},{default:u(()=>[n(a,{label:"用户名"},{default:u(()=>[n(f,{modelValue:s.usename,"onUpdate:modelValue":d[0]||(d[0]=y=>s.usename=y),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),n(a,{label:"密码"},{default:u(()=>[n(f,{type:"password",modelValue:s.password,"onUpdate:modelValue":d[1]||(d[1]=y=>s.password=y),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),c("div",Q,[Y,n(g,{type:t.value?"success":"primary",onClick:m,disabled:t.value},{default:u(()=>[x(C(t.value?"验证通过":"点我验证"),1)]),_:1},8,["type","disabled"])]),n(a,null,{default:u(()=>[n(g,{type:"primary",onClick:_,disabled:!t.value,style:{width:"100%"}},{default:u(()=>[x("登陆")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])])}}});const ye=w(Z,[["__scopeId","data-v-4b221408"]]);export{ye as default};
